<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AIchive — AI + Archive</title>
  <style>
    :root {
      --bg: #f6f6f6;
      --surface: #fff;
      --border: #ddd;
      --text: #333;
      --text-muted: #666;
      --accent: #b31b1b;
      --accent-hover: #8b1515;
      --link: #0066cc;
      --link-hover: #004499;
      --cat-bg: #f0f0f0;
      --header-bg: #fff;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: "Lucida Grande", "Noto Sans JP", Geneva, Helvetica, Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
      font-size: 14px;
    }

    a { color: var(--link); text-decoration: none; }
    a:hover { color: var(--link-hover); text-decoration: underline; }

    /* ─── Header ─── */
    .site-header {
      background: var(--header-bg);
      border-bottom: 3px solid var(--accent);
      padding: 1rem 0;
    }

    .header-inner {
      max-width: 980px;
      margin: 0 auto;
      padding: 0 1.5rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logo {
      display: flex;
      align-items: baseline;
      gap: 0.6rem;
    }

    .logo h1 {
      font-size: 1.8rem;
      font-weight: 700;
      color: var(--accent);
      letter-spacing: 0.02em;
    }

    .logo .tagline {
      font-size: 0.75rem;
      color: var(--text-muted);
      font-style: italic;
    }

    .header-nav {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .lang-switch {
      display: flex;
      border: 1px solid var(--border);
      border-radius: 4px;
      overflow: hidden;
    }

    .lang-btn {
      padding: 0.25rem 0.6rem;
      font-size: 0.8rem;
      background: transparent;
      color: var(--text-muted);
      border: none;
      cursor: pointer;
      transition: all 0.15s;
    }

    .lang-btn:not(:last-child) {
      border-right: 1px solid var(--border);
    }

    .lang-btn.active {
      background: var(--accent);
      color: #fff;
    }

    .lang-btn:hover:not(.active) {
      background: var(--cat-bg);
    }

    /* ─── Search ─── */
    .search-bar {
      max-width: 980px;
      margin: 0 auto;
      padding: 0.8rem 1.5rem;
      display: flex;
      gap: 0.5rem;
      align-items: center;
    }

    .search-bar input {
      flex: 1;
      padding: 0.4rem 0.6rem;
      border: 1px solid var(--border);
      border-radius: 4px;
      font-size: 0.9rem;
      font-family: inherit;
    }

    .search-bar input:focus {
      outline: none;
      border-color: var(--accent);
    }

    .search-bar button {
      padding: 0.4rem 1rem;
      background: var(--accent);
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.85rem;
    }

    .search-bar button:hover {
      background: var(--accent-hover);
    }

    /* ─── Main ─── */
    .container {
      max-width: 980px;
      margin: 0 auto;
      padding: 1.5rem;
    }

    /* ─── About banner ─── */
    .about-banner {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 4px;
      padding: 1rem 1.2rem;
      margin-bottom: 1.5rem;
      font-size: 0.9rem;
      color: var(--text-muted);
      line-height: 1.7;
    }

    .about-banner strong {
      color: var(--text);
    }

    /* ─── Subject areas ─── */
    .section-title {
      font-size: 1.1rem;
      font-weight: 700;
      color: var(--accent);
      margin-bottom: 0.8rem;
      padding-bottom: 0.3rem;
      border-bottom: 1px solid var(--border);
    }

    .subject-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 0.8rem;
      margin-bottom: 2rem;
    }

    .subject-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 4px;
      padding: 0.8rem 1rem;
      cursor: pointer;
      transition: border-color 0.15s;
    }

    .subject-card:hover {
      border-color: var(--accent);
    }

    .subject-card h3 {
      font-size: 0.95rem;
      font-weight: 700;
      color: var(--accent);
      margin-bottom: 0.2rem;
    }

    .subject-card .sub-desc {
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .subject-card .sub-count {
      font-size: 0.75rem;
      color: var(--text-muted);
      margin-top: 0.3rem;
    }

    /* ─── Recent papers ─── */
    .recent-section {
      margin-bottom: 2rem;
    }

    .paper-list {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 4px;
    }

    .paper-item {
      padding: 0.8rem 1rem;
      border-bottom: 1px solid var(--border);
      display: block;
      text-decoration: none;
      color: var(--text);
      transition: background 0.1s;
    }

    .paper-item:last-child {
      border-bottom: none;
    }

    .paper-item:hover {
      background: var(--cat-bg);
      text-decoration: none;
    }

    .paper-item .paper-id {
      font-size: 0.8rem;
      color: var(--accent);
      font-weight: 600;
      margin-right: 0.5rem;
    }

    .paper-item .paper-title {
      font-weight: 600;
      color: var(--link);
    }

    .paper-item:hover .paper-title {
      text-decoration: underline;
    }

    .paper-item .paper-meta {
      font-size: 0.8rem;
      color: var(--text-muted);
      margin-top: 0.2rem;
    }

    .paper-item .paper-desc {
      font-size: 0.85rem;
      color: var(--text-muted);
      margin-top: 0.3rem;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .paper-item .paper-tags {
      display: flex;
      gap: 0.4rem;
      margin-top: 0.3rem;
      flex-wrap: wrap;
    }

    .tag {
      background: var(--cat-bg);
      color: var(--text-muted);
      padding: 0.1rem 0.5rem;
      border-radius: 3px;
      font-size: 0.75rem;
    }

    /* ─── How to contribute ─── */
    .contribute {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 4px;
      padding: 1rem 1.2rem;
      margin-bottom: 2rem;
    }

    .contribute h2 {
      font-size: 1rem;
      font-weight: 700;
      color: var(--accent);
      margin-bottom: 0.6rem;
    }

    .contribute ol {
      padding-left: 1.5rem;
      color: var(--text-muted);
      font-size: 0.9rem;
    }

    .contribute li {
      margin-bottom: 0.3rem;
    }

    .contribute code {
      background: var(--cat-bg);
      padding: 0.1rem 0.35rem;
      border-radius: 3px;
      font-size: 0.85em;
    }

    .contribute .req {
      margin-top: 0.6rem;
      font-size: 0.85rem;
      color: var(--text-muted);
    }

    .contribute .req strong {
      color: var(--text);
    }

    /* ─── Empty state ─── */
    .empty-state {
      text-align: center;
      padding: 2rem;
      color: var(--text-muted);
    }

    /* ─── Footer ─── */
    footer {
      text-align: center;
      padding: 1.5rem 0;
      margin-top: 1rem;
      border-top: 1px solid var(--border);
      color: var(--text-muted);
      font-size: 0.8rem;
    }

    /* ─── Category filter (active state) ─── */
    .subject-card.active {
      border-color: var(--accent);
      background: #fff5f5;
    }

    .filter-reset {
      font-size: 0.85rem;
      color: var(--accent);
      cursor: pointer;
      margin-left: 0.8rem;
      display: none;
    }

    .filter-reset:hover {
      text-decoration: underline;
    }

    /* ─── Notice / Disclaimer ─── */
    .notice {
      background: #fff8e1;
      border: 1px solid #e6c84c;
      border-radius: 4px;
      padding: 0.8rem 1rem;
      margin-bottom: 1.5rem;
      font-size: 0.85rem;
      color: #665500;
      line-height: 1.7;
    }

    .notice strong {
      color: #554400;
    }

    .disclaimer {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 4px;
      padding: 0.8rem 1rem;
      margin-bottom: 1.5rem;
      font-size: 0.8rem;
      color: var(--text-muted);
      line-height: 1.7;
    }

    .disclaimer strong {
      color: var(--text);
    }
  </style>
</head>
<body>

  <!-- Header -->
  <div class="site-header">
    <div class="header-inner">
      <div class="logo">
        <h1>AIchive</h1>
        <span class="tagline" id="tagline">AI + Archive</span>
      </div>
      <div class="header-nav">
        <div class="lang-switch">
          <button class="lang-btn active" data-lang="ja">JA</button>
          <button class="lang-btn" data-lang="en">EN</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Search -->
  <div class="search-bar">
    <input type="text" id="search-input" placeholder="レポートを検索..." />
    <button id="search-btn" onclick="doSearch()">検索</button>
  </div>

  <div class="container">
    <!-- About -->
    <div class="about-banner" id="about-banner">
      <strong>AIchive</strong>は、あらゆる分野の知識を集約するオープンプラットフォームです。テーマを与えると、AIが各分野の専門家を模擬し、多角的な視点から100ラウンドのパネルディスカッションを自動実行。その議論をもとに学術レポートを生成します。
    </div>

    <!-- Notice -->
    <div class="notice" id="notice">
      <strong>ご利用にあたって:</strong> 本サイトのレポートはすべて<strong>AIによって生成</strong>されたものです。1件のレポート生成に高性能なAIモデルを大量に消費するため、Claude Pro/Maxプランでの <a href="https://claude.ai/download" target="_blank">Claude Code</a> 利用、またはAnthropic APIでの利用を想定しています。Webブラウザ上での生成機能はありません。
    </div>

    <!-- Disclaimer -->
    <div class="disclaimer" id="disclaimer">
      <strong>免責事項:</strong> 本サイトに掲載されるレポートは、Anthropic社のAIモデル「Claude」が専門家を模擬して生成したものであり、人間の専門家による査読や検証を経ていません。内容の正確性・完全性は保証されません。学術引用や意思決定の根拠として利用する場合は、必ず一次資料にあたってください。
    </div>

    <!-- Subject Areas -->
    <h2 class="section-title" id="subjects-title">分野別 <span class="filter-reset" id="filter-reset" onclick="resetFilter()">[すべて表示]</span></h2>
    <div class="subject-grid" id="subject-grid"></div>

    <!-- Recent Papers -->
    <div class="recent-section">
      <h2 class="section-title" id="recent-title">最新のレポート <span class="paper-count" id="count"></span></h2>
      <div class="paper-list" id="paper-list">
        <div class="empty-state" id="empty-state">
          <p>まだレポートはありません。</p>
        </div>
      </div>
    </div>

    <!-- How to contribute -->
    <div class="contribute" id="contribute">
      <h2 id="contribute-title">レポートを追加する</h2>
      <ol id="contribute-steps">
        <li>リポジトリをクローンし、Claude Code で開く</li>
        <li><code>/forge テーマ</code> を実行</li>
        <li>AIが各分野の専門家を模擬し、100ラウンドの議論を自動実行</li>
        <li>日本語+英語のレポートが生成され、このページに公開される</li>
      </ol>
      <div class="req" id="req-text">
        <strong>動作環境:</strong> <a href="https://claude.ai/download" target="_blank">Claude Code</a>（Claude Pro/Maxプランでの利用を想定）またはAnthropic API<br>
        <span style="font-size:0.8rem;">Claude Codeのカスタムコマンド（<code>/forge</code>）として動作します。1件のレポート生成で大量のトークンを消費するため、定額プラン（Pro/Max）の利用を推奨します。Anthropic APIでも利用可能ですが、従量課金のため高額になる場合があります。</span>
      </div>
    </div>

    <footer>
      <p>AIchive — Built with <a href="https://claude.ai/download" target="_blank">Claude Code</a></p>
    </footer>
  </div>

  <script>
    let currentLang = 'ja';
    let allPapers = [];
    let activeCategory = null;
    let searchQuery = '';

    // ── Subject categories ──
    const categories = {
      ja: [
        { id: 'law',         name: '法学・統治',        desc: '法律、制度設計、憲法、国際法' },
        { id: 'philosophy',   name: '哲学・思想',        desc: '存在論、認識論、倫理学、美学' },
        { id: 'science',      name: '科学・技術',        desc: '物理学、生物学、工学、情報科学' },
        { id: 'society',      name: '社会・文化',        desc: '社会学、人類学、歴史学、言語学' },
        { id: 'economics',    name: '経済・経営',        desc: '経済学、金融、経営戦略、労働' },
        { id: 'ethics',       name: '倫理・AI',          desc: 'AI倫理、生命倫理、技術倫理' },
        { id: 'environment',  name: '環境・エネルギー',  desc: '気候変動、持続可能性、資源' },
        { id: 'health',       name: '医療・生命科学',    desc: '医学、公衆衛生、神経科学' },
        { id: 'education',    name: '教育・人材',        desc: '教育制度、学習科学、人材開発' },
        { id: 'other',        name: 'その他',            desc: '分野横断的テーマ' }
      ],
      en: [
        { id: 'law',         name: 'Law & Governance',     desc: 'Law, institutional design, constitutional law, international law' },
        { id: 'philosophy',   name: 'Philosophy',           desc: 'Ontology, epistemology, ethics, aesthetics' },
        { id: 'science',      name: 'Science & Technology', desc: 'Physics, biology, engineering, computer science' },
        { id: 'society',      name: 'Society & Culture',    desc: 'Sociology, anthropology, history, linguistics' },
        { id: 'economics',    name: 'Economics & Business', desc: 'Economics, finance, management, labor' },
        { id: 'ethics',       name: 'Ethics & AI',          desc: 'AI ethics, bioethics, technology ethics' },
        { id: 'environment',  name: 'Environment & Energy', desc: 'Climate change, sustainability, resources' },
        { id: 'health',       name: 'Health & Life Science',desc: 'Medicine, public health, neuroscience' },
        { id: 'education',    name: 'Education',            desc: 'Education systems, learning science, human development' },
        { id: 'other',        name: 'Other',                desc: 'Cross-disciplinary topics' }
      ]
    };

    // ── i18n ──
    const i18n = {
      ja: {
        tagline: 'AI + Archive',
        about: '<strong>AIchive</strong>は、あらゆる分野の知識を集約するオープンプラットフォームです。テーマを与えると、AIが各分野の専門家を模擬し、多角的な視点から100ラウンドのパネルディスカッションを自動実行。その議論をもとに学術レポートを生成します。',
        notice: '<strong>ご利用にあたって:</strong> 本サイトのレポートはすべて<strong>AIによって生成</strong>されたものです。1件のレポート生成に高性能なAIモデルを大量に消費するため、Claude Pro/Maxプランでの <a href="https://claude.ai/download" target="_blank">Claude Code</a> 利用、またはAnthropic APIでの利用を想定しています。Webブラウザ上での生成機能はありません。',
        disclaimer: '<strong>免責事項:</strong> 本サイトに掲載されるレポートは、Anthropic社のAIモデル「Claude」が専門家を模擬して生成したものであり、人間の専門家による査読や検証を経ていません。内容の正確性・完全性は保証されません。学術引用や意思決定の根拠として利用する場合は、必ず一次資料にあたってください。',
        subjectsTitle: '分野別',
        recentTitle: '最新のレポート',
        contributeTitle: 'レポートを追加する',
        contributeSteps: [
          'リポジトリをクローンし、Claude Code で開く',
          '<code>/forge テーマ</code> を実行',
          'AIが各分野の専門家を模擬し、100ラウンドの議論を自動実行',
          '日本語+英語のレポートが生成され、このページに公開される'
        ],
        req: '<strong>動作環境:</strong> <a href="https://claude.ai/download" target="_blank">Claude Code</a>（Claude Pro/Maxプランでの利用を想定）またはAnthropic API<br><span style="font-size:0.8rem;">Claude Codeのカスタムコマンド（<code>/forge</code>）として動作します。1件のレポート生成で大量のトークンを消費するため、定額プラン（Pro/Max）の利用を推奨します。Anthropic APIでも利用可能ですが、従量課金のため高額になる場合があります。</span>',
        emptyTitle: 'まだレポートはありません。',
        filterReset: '[すべて表示]',
        experts: '名の専門家',
        rounds: 'ラウンド',
        noDate: '日付不明',
        count: '件',
        searchPlaceholder: 'レポートを検索...',
        searchBtn: '検索',
        nPapers: '件のレポート'
      },
      en: {
        tagline: 'AI + Archive',
        about: '<strong>AIchive</strong> is an open platform that aggregates knowledge from every discipline. Given a topic, AI simulates domain experts and conducts 100 rounds of panel discussion from multiple perspectives, then generates a comprehensive academic report.',
        notice: '<strong>Important:</strong> All reports on this site are <strong>generated entirely by AI</strong>. Each report consumes a significant amount of high-performance AI model usage. It is designed for use with <a href="https://claude.ai/download" target="_blank">Claude Code</a> on a Claude Pro/Max plan, or via the Anthropic API. There is no browser-based generation feature.',
        disclaimer: '<strong>Disclaimer:</strong> Reports published on this site are generated by Anthropic\'s AI model "Claude" simulating domain experts. They have not been peer-reviewed or verified by human specialists. Accuracy and completeness are not guaranteed. If citing for academic or decision-making purposes, always consult primary sources.',
        subjectsTitle: 'Subject Areas',
        recentTitle: 'Recent Reports',
        contributeTitle: 'Submit a Report',
        contributeSteps: [
          'Clone the repository and open it in Claude Code',
          'Run <code>/forge your topic</code>',
          'AI simulates domain experts and runs 100 rounds of discussion',
          'Reports in Japanese + English are generated and published here'
        ],
        req: '<strong>Environment:</strong> <a href="https://claude.ai/download" target="_blank">Claude Code</a> (designed for Claude Pro/Max plans) or Anthropic API<br><span style="font-size:0.8rem;">Runs as a Claude Code custom command (<code>/forge</code>). Each report consumes a large number of tokens, so a flat-rate plan (Pro/Max) is recommended. The Anthropic API can also be used, but pay-per-use billing may result in significant costs.</span>',
        emptyTitle: 'No reports yet.',
        filterReset: '[show all]',
        experts: ' experts',
        rounds: ' rounds',
        noDate: 'No date',
        count: ' reports',
        searchPlaceholder: 'Search reports...',
        searchBtn: 'Search',
        nPapers: ' reports'
      }
    };

    // ── Category mapping: match paper tags/title to categories ──
    const categoryKeywords = {
      law:         ['law', 'legal', 'governance', 'constitution', '法律', '法学', '統治', '憲法', '制度', '国家', '国際法'],
      philosophy:  ['philosophy', 'ontology', 'epistemology', '哲学', '思想', '存在', '認識', '形而上'],
      science:     ['science', 'physics', 'biology', 'technology', 'engineering', 'computer', '科学', '技術', '物理', '生物', '工学', '情報'],
      society:     ['society', 'culture', 'sociology', 'history', 'anthropology', '社会', '文化', '歴史', '人類学', '言語'],
      economics:   ['economics', 'economy', 'finance', 'business', '経済', '金融', '経営', '労働', '市場'],
      ethics:      ['ethics', 'ai ethics', 'bioethics', '倫理', 'AI倫理', '生命倫理', '意識'],
      environment: ['environment', 'climate', 'energy', 'sustainability', '環境', '気候', 'エネルギー', '持続可能'],
      health:      ['health', 'medicine', 'medical', 'neuroscience', '医療', '医学', '健康', '神経'],
      education:   ['education', 'learning', '教育', '学習', '人材']
    };

    function detectCategory(paper) {
      if (paper.category) return paper.category;
      const text = (paper.title + ' ' + (paper.tags || []).join(' ') + ' ' + (paper.description || '')).toLowerCase();
      for (const [catId, keywords] of Object.entries(categoryKeywords)) {
        for (const kw of keywords) {
          if (text.includes(kw.toLowerCase())) return catId;
        }
      }
      return 'other';
    }

    function switchLang(lang) {
      currentLang = lang;
      const t = i18n[lang];

      document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.lang === lang);
      });

      document.getElementById('about-banner').innerHTML = t.about;
      document.getElementById('notice').innerHTML = t.notice;
      document.getElementById('disclaimer').innerHTML = t.disclaimer;
      document.getElementById('subjects-title').innerHTML = t.subjectsTitle + ' <span class="filter-reset" id="filter-reset" onclick="resetFilter()">' + t.filterReset + '</span>';
      document.getElementById('recent-title').innerHTML = t.recentTitle + ' <span class="paper-count" id="count"></span>';
      document.getElementById('contribute-title').textContent = t.contributeTitle;
      document.getElementById('contribute-steps').innerHTML = t.contributeSteps.map(s => `<li>${s}</li>`).join('');
      document.getElementById('req-text').innerHTML = t.req;
      document.getElementById('search-input').placeholder = t.searchPlaceholder;
      document.getElementById('search-btn').textContent = t.searchBtn;

      renderSubjects();
      renderPapers();
    }

    function renderSubjects() {
      const lang = currentLang;
      const cats = categories[lang];
      const grid = document.getElementById('subject-grid');
      grid.innerHTML = '';

      const filtered = allPapers.filter(p => p.lang === lang);

      for (const cat of cats) {
        const count = filtered.filter(p => detectCategory(p) === cat.id).length;
        const card = document.createElement('div');
        card.className = 'subject-card' + (activeCategory === cat.id ? ' active' : '');
        card.onclick = () => toggleCategory(cat.id);
        card.innerHTML = `
          <h3>${cat.name}</h3>
          <div class="sub-desc">${cat.desc}</div>
          <div class="sub-count">${count}${i18n[lang].nPapers}</div>
        `;
        grid.appendChild(card);
      }
    }

    function toggleCategory(catId) {
      activeCategory = activeCategory === catId ? null : catId;
      renderSubjects();
      renderPapers();
      const resetEl = document.getElementById('filter-reset');
      if (resetEl) resetEl.style.display = activeCategory ? 'inline' : 'none';
    }

    function resetFilter() {
      activeCategory = null;
      searchQuery = '';
      document.getElementById('search-input').value = '';
      renderSubjects();
      renderPapers();
      const resetEl = document.getElementById('filter-reset');
      if (resetEl) resetEl.style.display = 'none';
    }

    function doSearch() {
      searchQuery = document.getElementById('search-input').value.trim().toLowerCase();
      renderPapers();
    }

    function renderPapers() {
      const lang = currentLang;
      const t = i18n[lang];
      const list = document.getElementById('paper-list');
      const countEl = document.getElementById('count');

      let filtered = allPapers.filter(p => p.lang === lang);

      if (activeCategory) {
        filtered = filtered.filter(p => detectCategory(p) === activeCategory);
      }

      if (searchQuery) {
        filtered = filtered.filter(p => {
          const text = (p.title + ' ' + (p.description || '') + ' ' + (p.tags || []).join(' ')).toLowerCase();
          return text.includes(searchQuery);
        });
      }

      if (filtered.length === 0) {
        list.innerHTML = `<div class="empty-state"><p>${t.emptyTitle}</p></div>`;
        if (countEl) countEl.textContent = '';
        return;
      }

      if (countEl) countEl.textContent = `(${filtered.length}${t.count})`;
      list.innerHTML = '';

      filtered.sort((a, b) => (b.date || '').localeCompare(a.date || ''));

      for (const paper of filtered) {
        const item = document.createElement('a');
        item.className = 'paper-item';
        item.href = `viewer.html?f=${paper.file}`;

        const expertCount = paper.experts || 10;
        const rounds = paper.rounds || 100;
        const dateStr = paper.date || t.noDate;

        item.innerHTML = `
          <div>
            <span class="paper-id">[aichive:${paper.date || '0000'}]</span>
            <span class="paper-title">${paper.title}</span>
          </div>
          <div class="paper-meta">${dateStr} — ${expertCount}${t.experts} — ${rounds}${t.rounds}</div>
          ${paper.description ? `<div class="paper-desc">${paper.description}</div>` : ''}
          <div class="paper-tags">
            ${(paper.tags || []).map(tag => `<span class="tag">${tag}</span>`).join('')}
          </div>
        `;
        list.appendChild(item);
      }
    }

    async function init() {
      try {
        const resp = await fetch('papers/index.json?v=' + Date.now());
        if (resp.ok) {
          allPapers = await resp.json();
        }
      } catch (e) {}

      renderSubjects();
      renderPapers();

      document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.addEventListener('click', () => switchLang(btn.dataset.lang));
      });

      document.getElementById('search-input').addEventListener('keydown', (e) => {
        if (e.key === 'Enter') doSearch();
      });
    }

    init();
  </script>
</body>
</html>
